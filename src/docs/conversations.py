"""Documentation strings для Conversations API."""

CREATE_CONVERSATION = """
Создаёт новый диалог для multi-turn conversations.

## Как это работает

1. Создаётся диалог с уникальным ID (`conv_{uuid}`)
2. Если указан `system_prompt`, он добавляется как первое сообщение
3. Диалог сохраняется в Redis с TTL (по умолчанию 7 дней)
4. Возвращается `conversation_id` для дальнейших запросов

## Параметры

| Параметр | Тип | Описание |
|----------|-----|----------|
| `model` | string | Модель по умолчанию для диалога (опционально) |
| `system_prompt` | string | Системный промпт (добавится как первое сообщение) |
| `metadata` | object | Дополнительные метаданные для диалога |

## Использование с Tasks API

После создания диалога используйте `conversation_id` в запросах к `/tasks`:

```json
{
  "model": "gpt-4-turbo",
  "prompt": "Привет!",
  "conversation_id": "conv_abc123"
}
```

## TTL и автоочистка

- Диалоги автоматически удаляются через 7 дней неактивности
- TTL обновляется при каждом обращении к диалогу
"""

GET_CONVERSATION = """
Возвращает метаданные диалога.

## Возвращаемые поля

| Поле | Описание |
|------|----------|
| `conversation_id` | Уникальный ID диалога |
| `model` | Модель по умолчанию |
| `system_prompt` | Системный промпт |
| `message_count` | Количество сообщений в истории |
| `created_at` | Время создания |
| `updated_at` | Время последнего обновления |
| `metadata` | Дополнительные метаданные |

## Примечание

Этот endpoint возвращает только метаданные.
Для получения сообщений используйте `GET /conversations/{conversation_id}/messages`.
"""

GET_CONVERSATION_DETAIL = """
Возвращает полную информацию о диалоге включая все сообщения.

## Возвращаемые поля

Все поля из базового endpoint плюс:

| Поле | Описание |
|------|----------|
| `messages` | Список всех сообщений в хронологическом порядке |

## Структура сообщения

| Поле | Описание |
|------|----------|
| `role` | Роль: `system`, `user`, `assistant` |
| `content` | Текст сообщения |
| `timestamp` | Время добавления |
"""

LIST_CONVERSATIONS = """
Возвращает список всех диалогов с пагинацией.

## Параметры запроса

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `limit` | int | 100 | Максимум диалогов в ответе |
| `offset` | int | 0 | Смещение для пагинации |

## Сортировка

Диалоги отсортированы по `conversation_id` в обратном порядке (новые первыми).

## Пагинация

Используйте `offset` для получения следующих страниц:
- Страница 1: `?limit=20&offset=0`
- Страница 2: `?limit=20&offset=20`
- Страница 3: `?limit=20&offset=40`
"""

UPDATE_CONVERSATION = """
Обновляет метаданные диалога.

## Параметры

| Параметр | Тип | Описание |
|----------|-----|----------|
| `model` | string | Новая модель по умолчанию |
| `system_prompt` | string | Новый системный промпт |
| `metadata` | object | Новые метаданные (заменяют старые) |

## Примечание

- Обновление системного промпта не влияет на существующие сообщения
- При необходимости можно очистить историю через `DELETE /conversations/{id}/messages`
"""

DELETE_CONVERSATION = """
Удаляет диалог и всю его историю сообщений.

## Что удаляется

- Метаданные диалога
- Все сообщения
- Запись из индекса диалогов

## Когда удалять

- Диалог больше не нужен
- GDPR compliance (удаление данных пользователя)
- Освобождение места в Redis

## Примечание

Удаление необратимо. Все данные будут потеряны.
"""

ADD_MESSAGE = """
Добавляет сообщение в историю диалога.

## Параметры

| Параметр | Тип | Описание |
|----------|-----|----------|
| `role` | string | Роль: `system`, `user`, `assistant` |
| `content` | string | Текст сообщения |

## Роли сообщений

| Роль | Когда использовать |
|------|-------------------|
| `system` | Системные инструкции (обычно одно в начале) |
| `user` | Сообщения от пользователя |
| `assistant` | Ответы модели |

## Лимит сообщений

- Максимум сообщений в истории: 100
- При превышении старые сообщения удаляются (FIFO)

## Автоматическое добавление

При использовании `conversation_id` в `/tasks`:
- `user` сообщение добавляется из `prompt`
- `assistant` сообщение добавляется после генерации

Ручное добавление через этот endpoint полезно для:
- Импорта истории из другой системы
- Добавления контекста без генерации
- Восстановления диалога
"""

GET_MESSAGES = """
Возвращает историю сообщений диалога.

## Параметры запроса

| Параметр | Тип | По умолчанию | Описание |
|----------|-----|--------------|----------|
| `limit` | int | все | Максимум сообщений (последние N) |

## Формат ответа

Массив сообщений в хронологическом порядке:

```json
{
  "messages": [
    {"role": "system", "content": "You are a helpful assistant.", "timestamp": "..."},
    {"role": "user", "content": "Hello!", "timestamp": "..."},
    {"role": "assistant", "content": "Hi there!", "timestamp": "..."}
  ]
}
```

## Лимит для контекста

По умолчанию в LLM отправляются последние 50 сообщений.
Это значение можно изменить при создании запроса.
"""

CLEAR_MESSAGES = """
Очищает историю сообщений диалога, сохраняя метаданные.

## Что очищается

- Все сообщения включая системный промпт

## Что сохраняется

- Метаданные диалога (model, metadata)
- `conversation_id`
- Счётчик сообщений сбрасывается на 0

## Когда использовать

- Начать диалог заново с той же конфигурацией
- Очистить чувствительные данные
- Сбросить контекст при смене темы
"""
