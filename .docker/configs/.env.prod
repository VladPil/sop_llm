# ========================================
# SOP LLM Service - Production Environment
# ========================================
# Оптимизировано для production deployment

# ========================================
# Application Settings
# ========================================
SOP__APP_NAME=SOP LLM Service
SOP__ENVIRONMENT=prod
SOP__DEBUG=false

# ========================================
# Server Settings
# ========================================
SOP__SERVER__HOST=0.0.0.0
SOP__SERVER__PORT=8023
SOP__SERVER__WORKERS=4
SOP__SERVER__TIMEOUT=180
SOP__SERVER__RELOAD=false

# API Port (внутренний порт контейнера)
API_PORT=8000

# ========================================
# Redis Settings
# ========================================
SOP__REDIS__HOST=${REDIS_HOST}
SOP__REDIS__PORT=${REDIS_PORT:-6379}
SOP__REDIS__DB=0
SOP__REDIS__PASSWORD=${REDIS_PASSWORD}
SOP__REDIS__POOL_MIN=10
SOP__REDIS__POOL_MAX=200

# ========================================
# Cache Settings
# ========================================
SOP__CACHE__ENABLED=true
SOP__CACHE__TTL=3600
SOP__CACHE__PREFIX=sop_llm:prod:

# ========================================
# LLM Settings
# ========================================
SOP__LLM__MODELS_CACHE_DIR=/root/.cache/huggingface/hub
SOP__LLM__DEFAULT_MODEL=Qwen/Qwen2.5-3B-Instruct
SOP__LLM__DEFAULT_EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
SOP__LLM__MAX_CONCURRENT_REQUESTS=10
SOP__LLM__MAX_TOKENS_PER_REQUEST=4096
SOP__LLM__REQUEST_TIMEOUT=180
SOP__LLM__MEMORY_THRESHOLD_PERCENT=80.0

# ========================================
# JSON Fixer Settings
# ========================================
SOP__JSON_FIXER__ENABLED=true
SOP__JSON_FIXER__MODEL=Qwen/Qwen2.5-7B-Instruct
SOP__JSON_FIXER__LOAD_IN_8BIT=true
SOP__JSON_FIXER__TIMEOUT=90
SOP__JSON_FIXER__MAX_ATTEMPTS=3

# ========================================
# Claude API Settings
# ========================================
SOP__CLAUDE__API_KEY=${CLAUDE_API_KEY}
SOP__CLAUDE__MODEL=claude-3-haiku-20240307
SOP__CLAUDE__MAX_CONCURRENT_REQUESTS=20

# ========================================
# Queue Settings
# ========================================
SOP__QUEUE__NAME=sop_llm_tasks_prod
SOP__QUEUE__MAX_RETRIES=5
SOP__QUEUE__RETRY_DELAY=10

# ========================================
# Logging Settings
# ========================================
SOP__LOG__LEVEL=WARNING
SOP__LOG__FORMAT=json
SOP__LOG__FILE_PATH=logs/sop-llm.log
SOP__LOG__ROTATION=100 MB
SOP__LOG__RETENTION=90 days

# ========================================
# Docker Settings
# ========================================
APP_PORT=8000
REDIS_PORT=6379
METRICS_PORT=9090

# GPU Support
INSTALL_GPU=true
CUDA_VERSION=12.1.0
DEVICE=cuda

# HuggingFace
HUGGINGFACE_TOKEN=${HUGGINGFACE_TOKEN}

# External API Keys
ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
OPENAI_API_KEY=${OPENAI_API_KEY}

# Performance (production optimized)
WORKERS=4
THREADS=16
TORCH_NUM_THREADS=16
OMP_NUM_THREADS=16

# GPU Configuration
NVIDIA_VISIBLE_DEVICES=all
NVIDIA_DRIVER_CAPABILITIES=compute,utility

# Security
# В production эти значения должны быть установлены через секреты
# REDIS_PASSWORD=<set via secrets>
# CLAUDE_API_KEY=<set via secrets>
# ANTHROPIC_API_KEY=<set via secrets>
# OPENAI_API_KEY=<set via secrets>
# HUGGINGFACE_TOKEN=<set via secrets>
